<!DOCTYPE html>
<html>
    <head>
        <title>TIC TAC TOE</title>
        <meta charset="windows-1252">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <style>
            
            *{box-sizing: border-box}
            
            .container{width: 300px;
                       overflow: hidden;
                       margin: 50px auto 0 auto;
                     }
            
            .container span{width: 100%;
                            display: block;
                            text-align: center;
                            font-family: sans-serif;
                            color: #fff;
                            font-size: 25px;
                            background: #446CB3;
                           }
            
            .container .box{float: left;
                            width: 100px;
                            height: 100px;
                            border: 1px solid #000;
                            transition: all .25s ease-in-out;
                            font-family: sans-serif; 
                            font-size: 85px;
                            text-align: center;
                            line-height: 100px; 
                            cursor: pointer;
                          }
            
            .container .box:hover{background: rgba(10,10,10,0.5);
                                  color: #fff
                                 }
            
            button{background: #26C281;
                   color: #fff;
                   font-weight: bold;
                   border: 1px solid yellow;
                    cursor: pointer; 
                    width: 200px;
                    height: 40px; 
                    font-size: 22px;
                    display: block;
                    margin: 10px auto}
            
            .win{background: #F9690E; color: #fff}

            p{
              text-align: right;
              font-size: 30px;
              margin-top: 100px;
            }
            
        </style>
        
    </head>
    <body>
       
        <div class="container" id="main">
            <span id="turn">Play</span>
            <!-- show X or O on div click -->
            <div class="box" id="box1"></div>
            <div class="box" id="box2"></div>
            <div class="box" id="box3"></div>
            <div class="box" id="box4"></div>
            <div class="box" id="box5"></div>
            <div class="box" id="box6"></div>
            <div class="box" id="box7"></div>
            <div class="box" id="box8"></div>
            <div class="box" id="box9"></div>
        </div>
        <!-- Play Again And Reset All Info -->
        
       
       <span id="countdowntimer" style="display:none"></span>
      <div class="w3-container">
        <h2>Points Table</h2>
       <table class="w3-table w3-bordered" id="points">
           <tr>
            <th>serial_no</th>
            <th>result</th>
            <th>player1_totalscore</th>
            <th>player2_totalscore</th>
        </tr>
        <tr id="individual" style="display:none">
            <td>{no}</td>
            <td>{res}</td>
            <td>{p1}</td>
            <td>{p2}</td>
        </tr>
       </table>
   </div>

        <script type="text/javascript">
             var timeleft=4,rest,
             turn = document.getElementById("turn"),
             // boxes => all boxes
            // X_or_O => to set X or O into the box
                boxes = document.querySelectorAll("#main div"), X_or_O = 0;
                var p1score=0,p2score=0;
                var ps1="X",ps2="O";
                var play=true;
            
            function selectWinnerBoxes(b1,b2,b3){
                b1.classList.add("win");
                b2.classList.add("win");
                b3.classList.add("win");
                play=false;
                if(b1.innerHTML==ps1){rest=1;p1score+=4;}
                else{rest=2;p2score+=4;}

                
                turn.innerHTML = b1.innerHTML + " Won Congrats";
                turn.style.fontSize = "40px";
            }
            
            function getWinner(){
                
                var box1 = document.getElementById("box1"),
                    box2 = document.getElementById("box2"),
                    box3 = document.getElementById("box3"),
                    box4 = document.getElementById("box4"),
                    box5 = document.getElementById("box5"),
                    box6 = document.getElementById("box6"),
                    box7 = document.getElementById("box7"),
                    box8 = document.getElementById("box8"),
                    box9 = document.getElementById("box9");
            
            // get all posibilites
              if(box1.innerHTML !== "" && box1.innerHTML === box2.innerHTML && box1.innerHTML === box3.innerHTML)
                 {
                    selectWinnerBoxes(box1,box2,box3);
                 addRow();
                 document.getElementById("countdowntimer").textContent = "Player " + rest.toString() + " won! Starting a new game in " + 5 + " seconds...";
    document.getElementById("countdowntimer").style.display="inline"; 
                  var downloadTimer = setInterval(function(){
    if(timeleft == 0){
        document.getElementById("countdowntimer").style.display="none";
        clearInterval(downloadTimer);
        replay();}
    if(timeleft!=0){document.getElementById("countdowntimer").textContent = "Player " + rest.toString() + " won! Starting a new game in " + timeleft.toString() + " seconds...";
    document.getElementById("countdowntimer").style.display="inline";
    timeleft--;}
    },1000);
                  timeleft=4;}
         
              else if(box4.innerHTML !== "" && box4.innerHTML === box5.innerHTML && box4.innerHTML === box6.innerHTML)
                 {
                    selectWinnerBoxes(box4,box5,box6); 
                    addRow(); 
                    document.getElementById("countdowntimer").textContent = "Player " + rest.toString() + " won! Starting a new game in " + 5 + " seconds...";
    document.getElementById("countdowntimer").style.display="inline"; 
                 var downloadTimer = setInterval(function(){
    if(timeleft == 0){
        document.getElementById("countdowntimer").style.display="none";
        clearInterval(downloadTimer);
        replay();}
    if(timeleft!=0){document.getElementById("countdowntimer").textContent = "Player " + rest.toString() + " won! Starting a new game in " + timeleft.toString() + " seconds...";
    document.getElementById("countdowntimer").style.display="inline";
    timeleft--;}
    },1000);
                  timeleft=4;}
             
              else if(box7.innerHTML !== "" && box7.innerHTML === box8.innerHTML && box7.innerHTML === box9.innerHTML)
                 {
                    selectWinnerBoxes(box7,box8,box9); 
                    addRow(); 
                    document.getElementById("countdowntimer").textContent = "Player " + rest.toString() + " won! Starting a new game in " + 5 + " seconds...";
    document.getElementById("countdowntimer").style.display="inline"; 
                 var downloadTimer = setInterval(function(){
    if(timeleft == 0){
        document.getElementById("countdowntimer").style.display="none";
        clearInterval(downloadTimer);
        replay();}
    if(timeleft!=0){document.getElementById("countdowntimer").textContent = "Player " + rest.toString() + " won! Starting a new game in " + timeleft.toString() + " seconds...";
    document.getElementById("countdowntimer").style.display="inline";
    timeleft--;}
    },1000);
                  timeleft=4;}
             
              else if(box1.innerHTML !== "" && box1.innerHTML === box4.innerHTML && box1.innerHTML === box7.innerHTML)
                 {
                    selectWinnerBoxes(box1,box4,box7); 
                    addRow(); 
                    document.getElementById("countdowntimer").textContent = "Player " + rest.toString() + " won! Starting a new game in " + 5 + " seconds...";
    document.getElementById("countdowntimer").style.display="inline"; 
                 var downloadTimer = setInterval(function(){
    if(timeleft == 0){
        document.getElementById("countdowntimer").style.display="none";
        clearInterval(downloadTimer);
        replay();}
    if(timeleft!=0){document.getElementById("countdowntimer").textContent = "Player " + rest.toString() + " won! Starting a new game in " + timeleft.toString() + " seconds...";
    document.getElementById("countdowntimer").style.display="inline";
    timeleft--;}
    },1000);
                  timeleft=4;}
             
              else if(box2.innerHTML !== "" && box2.innerHTML === box5.innerHTML && box2.innerHTML === box8.innerHTML)
                 {
                    selectWinnerBoxes(box2,box5,box8); 
                    addRow(); 
                    document.getElementById("countdowntimer").textContent = "Player " + rest.toString() + " won! Starting a new game in " + 5 + " seconds...";
    document.getElementById("countdowntimer").style.display="inline"; 
                 var downloadTimer = setInterval(function(){
    if(timeleft == 0){
        document.getElementById("countdowntimer").style.display="none";
        clearInterval(downloadTimer);
        replay();}
    if(timeleft!=0){document.getElementById("countdowntimer").textContent = "Player " + rest.toString() + " won! Starting a new game in " + timeleft.toString() + " seconds...";
    document.getElementById("countdowntimer").style.display="inline";
    timeleft--;}
    },1000);
                  timeleft=4;}
             
              else if(box3.innerHTML !== "" && box3.innerHTML === box6.innerHTML && box3.innerHTML === box9.innerHTML)
                 {
                    selectWinnerBoxes(box3,box6,box9);
                 addRow(); 
                 document.getElementById("countdowntimer").textContent = "Player " + rest.toString() + " won! Starting a new game in " + 5 + " seconds...";
    document.getElementById("countdowntimer").style.display="inline"; 
                 var downloadTimer = setInterval(function(){
    if(timeleft == 0){
        document.getElementById("countdowntimer").style.display="none";
        clearInterval(downloadTimer);
        replay();}
    if(timeleft!=0){document.getElementById("countdowntimer").textContent = "Player " + rest.toString() + " won! Starting a new game in " + timeleft.toString() + " seconds...";
    document.getElementById("countdowntimer").style.display="inline";
    timeleft--;}
    },1000);
                  timeleft=4;}
             
              else if(box1.innerHTML !== "" && box1.innerHTML === box5.innerHTML && box1.innerHTML === box9.innerHTML)
                 {
                    selectWinnerBoxes(box1,box5,box9); 
                    addRow(); 
                    document.getElementById("countdowntimer").textContent = "Player " + rest.toString() + " won! Starting a new game in " + 5 + " seconds...";
    document.getElementById("countdowntimer").style.display="inline"; 
                 var downloadTimer = setInterval(function(){
    if(timeleft == 0){
        document.getElementById("countdowntimer").style.display="none";
        clearInterval(downloadTimer);
        replay();}
    if(timeleft!=0){document.getElementById("countdowntimer").textContent = "Player " + rest.toString() + " won! Starting a new game in " + timeleft.toString() + " seconds...";
    document.getElementById("countdowntimer").style.display="inline";
    timeleft--;}
    },1000);
                  timeleft=4;}
             
              else if(box3.innerHTML !== "" && box3.innerHTML === box5.innerHTML && box3.innerHTML === box7.innerHTML)
                 {
                    selectWinnerBoxes(box3,box5,box7); 
                    addRow(); 
                    document.getElementById("countdowntimer").textContent = "Player " + rest.toString() + " won! Starting a new game in " + 5 + " seconds...";
    document.getElementById("countdowntimer").style.display="inline"; 
                 var downloadTimer = setInterval(function(){
    if(timeleft == 0){
        document.getElementById("countdowntimer").style.display="none";
        clearInterval(downloadTimer);
        replay();}
    if(timeleft!=0){document.getElementById("countdowntimer").textContent = "Player " + rest.toString() + " won! Starting a new game in " + timeleft.toString() + " seconds...";
    document.getElementById("countdowntimer").style.display="inline";
    timeleft--;}
    },1000);
                  timeleft=4;}
             
            }

            function tie(){
                if(box1.innerHTML!=="" && box2.innerHTML!=="" && box3.innerHTML!=="" && box4.innerHTML!=="" && box5.innerHTML!=="" && box6.innerHTML!=="" && box7.innerHTML!=="" && box8.innerHTML!=="" && box9.innerHTML!=="" && rest!=1 && rest!=2){play=false;
                    rest="T";
                p2score+=1;p1score+=1;
                addRow();
                document.getElementById("countdowntimer").textContent = "Match tied! Starting a new game in " + 5 + " seconds...";
    document.getElementById("countdowntimer").style.display="inline";
                var downloadTimer = setInterval(function(){
    if(timeleft == 0){
        document.getElementById("countdowntimer").style.display="none";
        clearInterval(downloadTimer);
        replay();}
    if(timeleft!=0){document.getElementById("countdowntimer").textContent = "Match tied! Starting a new game in " + timeleft.toString() + " seconds...";
    document.getElementById("countdowntimer").style.display="inline";
    timeleft--;}
    },1000);
                  
              timeleft=4;}


            }
            
            
            // set event onclick
            for(var i = 0; i < boxes.length; i++){
                boxes[i].onclick = function(){
                    // not allow to change the value of the box
                    if(this.innerHTML !== "X" && this.innerHTML !== "O" && play){
                    if(X_or_O%2 === 0){
                        console.log(X_or_O);
                        this.innerHTML = "X";
                        turn.innerHTML = "O Turn now";

                        getWinner();tie();
                        X_or_O += 1;
            }
            
           else{
                        console.log(X_or_O);
                       this.innerHTML = "O";
                       turn.innerHTML = "X Turn Now";
                       
                       getWinner();tie();
                       X_or_O += 1;  
                    }
                
                    
                }
                else if(play==false){
                    timeleft=0;
                    document.getElementById("countdowntimer").style.display="none";
                    replay();
                    if(ps1=="X"){ps1="O";ps2="X";}
                else{ps1="X";ps2="O";}}

                }
            }
            
            
            function replay(){
                
                for(var i = 0; i < boxes.length; i++){
                    boxes[i].classList.remove("win");
                    boxes[i].innerHTML = "";
                    turn.innerHTML = "Play";
                    turn.style.fontSize = "25px";
                   
                }
                X_or_O=0;
                if(ps1=="X"){ps1="O";ps2="X";}
                else{ps1="X";ps2="O";}
                play=true;
                rest="T"; 

            }

            var maxID = 0;
function getTemplateRow() {
var x = document.getElementById("individual").cloneNode(true);
x.id = "";
x.style.display = "";
x.innerHTML = x.innerHTML.replace(/{no}/, ++maxID);
x.innerHTML = x.innerHTML.replace(/{res}/, rest);
x.innerHTML = x.innerHTML.replace(/{p1}/, p1score);
x.innerHTML = x.innerHTML.replace(/{p2}/, p2score);
return x;
}
function addRow() {
var t = document.getElementById("points");
var rows = t.getElementsByTagName("tr");
var r = rows[rows.length-1];
r.parentNode.insertBefore(getTemplateRow(), r);

}      
        </script>
        
    </body>
</html>
